<html>
<!--
    TODO(bryantd): This entire file can be removed once the client-side pieces exist to communicate
    with the notebook server.  This is just a minimal bit of code to be able to drive the notebook
    server from the browser's javascript console.

    Open the browser console and run "execute(<code>)"; replies from the notebook server will
    appear within the browser console (nothing fancy).
-->
<script src="/socket.io/socket.io.js"></script>
<script>

 function kernelIsBusy (isBusy) {
   console.info('Kernel is ' + (isBusy ? 'busy' : 'idle'));
 }
 function notifyKernelDied () {
   console.info('Your kernel has died!');
 }

var socket = io.connect('http://localhost:9000');

socket.on('kernel-status', function (message) {
  if (message.status == 'busy') {
    kernelIsBusy(true);
  } else if (message.status == 'idle') {
    kernelIsBusy(false);
  } else if (message.status == 'dead') {
    notifyKernelDied();
  } else {
    // TODO: also handle kernel status = 'starting'
    console.error('kernel state: ', message.status);
  }
});

socket.on('execute-result', function (message) {
  console.info('Result: ', message.result['text/plain']);
});

socket.on('execute-reply', function (message) {
  if (message.success === false) {
    console.error(message.errorName, message.errorMessage);
  }
  console.info('Execution Counter',  '[' + message.executionCount + ']');
});

var i = 0;
function execute (code) {
  socket.emit('execute', {
    requestId: 'request-' + i++,
    code: code
  });
}

console.log('online');
</script>
